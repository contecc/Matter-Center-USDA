!function(e){"use strict";function t(e){return!isNaN(parseFloat(e))&&isFinite(e)}e.module("angulartics.azure",["angulartics"]).config(["$analyticsProvider",function(a,n){a.registerPageTrack(function(e,t){appInsights.trackPageView(e,t.absUrl(),{"App Type":configs.appInsights.appType})}),a.registerEventTrack(function(a,n){var i={},r={};e.forEach(n,function(e,a){t(e)?r[a]=parseFloat(e):i[a]=e}),appInsights.trackEvent(a,i,r)})}])}(angular),function(e){var t=e("#jquery-a11yfy-politeannouncer"),a=e("#jquery-a11yfy-assertiveannouncer"),n={showAndFocus:function(t){var a=t?e(t):t;return this.each(function(t,n){var i=e(n);i.show(),a&&a.length&&("iOS"===r?(e("body").focus(),setTimeout(function(){a.focus()},1e3)):a.focus())})},focus:function(){return this.each(function(t,a){var n=e(a);"iOS"===r?(e("body").focus(),setTimeout(function(){n.focus()},1e3)):n.focus()})},validate:function(t){var a=e.extend({},e.fn.a11yfy.defaults.validate,t);return this.each(function(t,n){function i(){}function r(){}function l(t,n){var i,r=[],l=e(this),o=l.find(".a11yfy-error-summary"),s=e("<ul>");for(i in n.invalid)n.invalid.hasOwnProperty(i)&&r.push(i);l.find("a.a11yfy-skip-link").remove(),l.find(".a11yfy-validation-error").removeClass("a11yfy-validation-error"),l.find(".a11yfy-error-message").remove(),o.empty(),e(r).each(function(t,i){var l,o,f=e("#"+i),u=e('label[for="'+i+'"]');u.addClass("a11yfy-validation-error"),f.addClass("a11yfy-validation-error"),s.append('<li><a class="a11yfy-skip-link a11yfy-summary-link" href="#'+i+'">'+u.text()+"</a> : "+n.invalid[i]+"</li>"),t<r.length-1&&a.skipLink&&(l=e('<a href="#" class="a11yfy-skip-link">'),l.text(e.a11yfy.getI18nString("skipToNextError",void 0,e.fn.a11yfy.defaults.strings)),l.attr("href","#"+r[t+1]),"P"===f.parent()[0].nodeName?f.parent().after(l):f.after(l)),o=e('<span class="a11yfy-error-message">'),o.text(" - "+n.invalid[i]),u.append(o)}),a.summary&&o.append(s)}var o=e(n),s=e.extend({},a.validatorOptions,{invalidHandler:l,errorPlacement:i,showErrors:r});o.validate(s),a.skipLink&&o.delegate("a.a11yfy-skip-link","click",function(t){var a=e(t.target);e(a.attr("href")).select().focus(),t.preventDefault(),t.stopPropagation()}),o.children().first().before(e('<div class="a11yfy-error-summary" role="alert" aria-live="assertive">')),o.find("[required]").attr("aria-required","true")})},menu:function(){return this.each(function(t,a){var n=e(a),i=n;if("UL"!==a.nodeName)throw new Error("The menu container must be an unordered list");n.find("a").attr("tabindex","-1"),n.attr("role","menubar").addClass("a11yfy-top-level-menu"),n.find(">li>ul").addClass("a11yfy-second-level-menu").parent().addClass("a11yfy-has-submenu").attr("aria-haspopup","true"),n.find(">li>ul>li>ul").addClass("a11yfy-third-level-menu").parent().addClass("a11yfy-has-submenu").attr("aria-haspopup","true"),n.find("li").each(function(t,a){var n=e(a);n.attr({role:"menuitem",tabindex:"-1"}),n.find("ul").each(function(t,a){e(a).attr("role","menu")})}).on("keypress",function(t){var a,n,r=t.charCode||t.which||t.keyCode,l=String.fromCharCode(r).toLowerCase(),o=-1,s=this,f=e(this),u=i.find('li[role="menuitem"]:visible');return 9===r?!0:(u.each(function(t,i){i===s&&(o=t),t>o&&!a&&0===e(i).text().trim().toLowerCase().indexOf(l)&&(-1!==o?a=e(i):n||(n=e(i)))}),!a&&n&&(a=n),a&&(a.attr("tabindex","0").focus(),f.attr("tabindex","-1"),a.parent().get(0)!==f.parent().get(0)&&f.parent().parent("li").removeClass("open")),void t.stopPropagation())}).on("keydown",function(t){function a(){o.hasClass("a11yfy-has-submenu")&&(o.addClass("open").find(">ul>li:visible").first().attr("tabindex","0").focus(),o.attr("tabindex","-1"))}function n(){var e=o;for(o.attr("tabindex","-1");;){if(e.prev().is(":visible"))return void e.prev().attr("tabindex","0").focus();if(e=e.prev(),!e.prev().length&&(e=o.parent().find(">li").last(),e.is(":visible")))return void e.attr("tabindex","0").focus();if(e[0]===o[0]){o.attr("tabindex","0");break}}}function i(){var e=o;for(o.attr("tabindex","-1");;){if(e.next().is(":visible"))return void e.next().attr("tabindex","0").focus();if(e=e.next(),!e.next().length&&(e=o.parent().find(">li").first(),e.is(":visible")))return void e.attr("tabindex","0").focus();if(e[0]===o[0]){o.attr("tabindex","0");break}}}var r=t.which||t.keyCode,l=!1,o=e(this);if(!(t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)){switch(r){case 32:case 13:l=!0,o.find(">a").length?o.find(">a")[0].click?o.find(">a")[0].click():o.find(">a").first().trigger("click"):a();break;case 37:case 27:l=!0,37===r&&o.parent().hasClass("a11yfy-top-level-menu")?n():"menu"===o.parent().attr("role")&&(o.parent().parent().attr("tabindex","0").focus().removeClass("open"),o.attr("tabindex","-1"));break;case 38:l=!0,o.parent().hasClass("a11yfy-top-level-menu")?a():n();break;case 39:l=!0,o.parent().hasClass("a11yfy-top-level-menu")?i():a();break;case 40:l=!0,o.parent().hasClass("a11yfy-top-level-menu")?a():i()}return l&&(t.preventDefault(),t.stopPropagation()),!0}}).on("blur",function(){}).on("click",function(){var t=e(this);t.hasClass("open")?t.removeClass("open"):t.addClass("open")}).first().attr("tabindex","0"),n.on("keydown",function(t){var a=!1,i=t.which||t.keyCode;if(!(t.ctrlKey||t.altKey||t.metaKey))return 9!==i?!0:(n.find(">li").each(function(t,n){"0"===e(n).attr("tabindex")&&(a=!0)}),a||(n.find(">li li[tabindex=0]").attr("tabindex","-1"),setTimeout(function(){n.find("li.open").each(function(t,a){e(a).parent().hasClass("a11yfy-top-level-menu")&&e(a).attr("tabindex","0")}).removeClass("open")},0)),!0)})})}},i=window.navigator.userAgent,r=i.match(/iPhone|iPad|iPod/)?"iOS":i.match(/Mac OS X/)?"OSX":i.match(/Windows/)?"Windows":"Other";e.a11yfy=function(){a.empty()},e.fn.a11yfy=function(t){return n[t]?n[t].apply(this,Array.prototype.slice.call(arguments,1)):void e.error("Method "+t+" does not exist on jQuery.a11yfy")},e.fn.a11yfy.defaults={strings:{skipToNextError:"skip to next field with an error"},validate:{skipLink:!0,summary:!0,validatorOptions:{}}},e.a11yfy.getI18nString=function(e,t,a){var n,i=a[e];if(t)for(n in t)i=i.replace("${"+n+"}",t[n]);return i},e.a11yfy.politeAnnounce=function(a){t.empty().append(e("<p>").text(a))},e.a11yfy.assertiveAnnounce=function(t){a.empty().append(e("<p>").text(t))},t&&t.length||e(document).ready(function(){t=e("<div>").attr({id:"jquery-a11yfy-politeannounce",role:"log","aria-live":"polite","aria-relevant":"additions"}).addClass("offscreen"),e("body").append(t)}),a&&a.length||e(document).ready(function(){a=e("<div>").attr({id:"jquery-a11yfy-assertiveannounce",role:"log","aria-live":"assertive","aria-relevant":"additions"}).addClass("offscreen"),e("body").append(a)})}(jQuery),function($,window,document,undefined){function Plugin(e,t){this.element=e,this.settings=$.extend({},defaults,t),this._defaults=defaults,this._name=pluginName,this.init()}function getFileName(e){return(e.filename?e.filename:"table2excel")+(e.fileext?e.fileext:".xls")}var pluginName="table2excel",defaults={exclude:".noExl",name:"Table2Excel"};Plugin.prototype={init:function(){var e=this,t='<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';e.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">'+t+"<head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>",sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"},e.tableRows=[],$(e.element).each(function(t,a){var n="";$(a).find("tr").not(e.settings.exclude).each(function(e,t){n+="<tr>"+$(t).html()+"</tr>"}),e.tableRows.push(n)}),e.tableToExcel(e.tableRows,e.settings.name,e.settings.sheetName)},tableToExcel:function(table,name,sheetName){var e=this,fullTemplate="",i,link,a;if(e.uri="data:application/vnd.ms-excel;base64,",e.base64=function(e){return window.btoa(unescape(encodeURIComponent(e)))},e.format=function(e,t){return e.replace(/{(\w+)}/g,function(e,a){return t[a]})},sheetName="undefined"==typeof sheetName?"Sheet":sheetName,e.ctx={worksheet:name||"Worksheet",table:table,sheetName:sheetName},fullTemplate=e.template.head,$.isArray(table))for(i in table)fullTemplate+=e.template.sheet.head+sheetName+i+e.template.sheet.tail;if(fullTemplate+=e.template.mid,$.isArray(table))for(i in table)fullTemplate+=e.template.table.head+"{table"+i+"}"+e.template.table.tail;fullTemplate+=e.template.foot;for(i in table)e.ctx["table"+i]=table[i];if(delete e.ctx.table,window.navigator.msSaveOrOpenBlob)if("undefined"!=typeof Blob){for(var i in table){var reg=eval("/{table["+i+"]}/");fullTemplate=fullTemplate.replace(reg,table[i])}fullTemplate=[fullTemplate];var blob1=new Blob(fullTemplate,{type:"text/html"});window.navigator.msSaveBlob(blob1,getFileName(e.settings))}else txtArea1.document.open("text/html","replace"),txtArea1.document.write(e.format(fullTemplate,e.ctx)),txtArea1.document.close(),txtArea1.focus(),sa=txtArea1.document.execCommand("SaveAs",!0,getFileName(e.settings));else link=e.uri+e.base64(e.format(fullTemplate,e.ctx)),a=document.createElement("a"),a.download=getFileName(e.settings),a.href=link,document.body.appendChild(a),a.click(),document.body.removeChild(a);return!0}},$.fn[pluginName]=function(e){var t=this;return t.each(function(){$.data(t,"plugin_"+pluginName)||$.data(t,"plugin_"+pluginName,new Plugin(this,e))}),t}}(jQuery,window,document);